%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[a4paper,11pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



% begin user_preamble:
\usepackage{mathrsfs}
\usepackage{amsmath}
\usepackage{amssymb}
% end user_preamble


\title{Tutorial}
\date{Sep 01, 2020}
\release{5.4.1}
\author{Yves Renard, Julien Pommier, Konstantinos Poulios}
\newcommand{\sphinxlogo}{\sphinxincludegraphics{logogetfem.png}\par}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{tutorial/index::doc}}



\chapter{Introduction}
\label{\detokenize{tutorial/intro:introduction}}\label{\detokenize{tutorial/intro:ud-intro-tut}}\label{\detokenize{tutorial/intro::doc}}
This tutorial is intended to present the main aspects of the \sphinxstyleemphasis{GetFEM} library  on commented simple examples. \sphinxstyleemphasis{GetFEM} allows numerical modeling of complex problems including coupled ones. It is relatively simple to add arbitrary coupling terms thanks to a weak form description language. Expressions in weak form are then compiled in the form of a list of optimized instructions that are executed during assembly.

The main presented functionalities are the following
\begin{itemize}
\item {} 
Approximation of multiphysics problems and the use of the generic assembly.

\item {} 
The use of fixed\sphinxhyphen{}size variables.

\item {} 
Contact problems.

\item {} 
Fictitious domain functionalities and transformations allowing inter\sphinxhyphen{}mesh or inter\sphinxhyphen{}region assembly.

\item {} 
Continuation / bifurcation problems.

\end{itemize}

This tutorial does not of course takes the place of the various documentations. The user documentation (that of the C++ library) is the reference one concerning the description of implemented methods. Interfaces documentations describe the use of the different functionalities from interfaces but do not repeat the description of methods. ‘Developpers’s guide’ documentation describes more internal concerning the organization of the library.

\sphinxstyleemphasis{GetFEM} is a free collaborative project hosted by the \sphinxhref{http://savannah.gnu.org}{Savannah} site (see \sphinxurl{https://savannah.nongnu.org/projects/getfem}). New contributors are welcome to all aspects of the project.


\section{C++, Python, Scilab or Matlab ?}
\label{\detokenize{tutorial/intro:c-python-scilab-or-matlab}}
\sphinxstyleemphasis{GetFEM} is basically a library written in C++. However, it has an interface that is available in Python, Scilab and Matlab  versions and allows to use all the advanced features. It is recommended to start by using the interface with scripting languages, which makes programming easier. The three versions of the interface differ only by small syntax elements, except for the graphics post\sphinxhyphen{}processing (Scilab and Matlab interfaces offer the possibility of integrated post\sphinxhyphen{}processing while it is necessary to use dedicated software such as Paraview, Mayavi or gmsh when using the Python interface or directly the library in C++). The Python interface is compiled by default along with the C++ library.

Use \sphinxstyleemphasis{GetFEM} interface is a good strategy even for complex applications, the performance is comparable to the direct use of the C++ library and it is more flexible to use. However, only the Python interface allows for the parallelization (with MPI). The possible addition of functionality to the interface being a relatively simple operation.

The first example of the tutorial (thermo\sphinxhyphen{}electric coupling elastico) allows to see the difference in the use of the C++ library and one of the versions of the interface.


\section{Where are demo files ?}
\label{\detokenize{tutorial/intro:where-are-demo-files}}
A large number of demonstration programs can be found
\begin{itemize}
\item {} 
for the C++ examples in directory:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{tests}\PYG{o}{/}
\end{sphinxVerbatim}

\item {} 
for the Python interface in the directory:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{interface}\PYG{o}{/}\PYG{n}{tests}\PYG{o}{/}\PYG{n}{python}
\end{sphinxVerbatim}

\item {} 
for the Scilab interface in the directory:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{interface}\PYG{o}{/}\PYG{n}{scr}\PYG{o}{/}\PYG{n}{scilab}\PYG{o}{/}\PYG{n}{demos}
\end{sphinxVerbatim}

\item {} 
and for the Matlab interface in the directory:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{interface}\PYG{o}{/}\PYG{n}{tests}\PYG{o}{/}\PYG{n}{matlab}
\end{sphinxVerbatim}

\end{itemize}


\chapter{How to install}
\label{\detokenize{tutorial/install:how-to-install}}\label{\detokenize{tutorial/install:ud-install-tut}}\label{\detokenize{tutorial/install::doc}}
Since \sphinxstyleemphasis{GetFEM} is developed on linux (Ubuntu), the installation is simpler on linux, especially on Debian\sphinxhyphen{}based distributions (Debian/Ubuntu/Mint). However, \sphinxstyleemphasis{GetFEM} can be installed also on other linux distributions, on Mac os X and Windows. In order to compile \sphinxstyleemphasis{GetFEM} from sources, you need a recent C++ complier (supporting C++ 14 standard) and a recent version of python.

The main dependences of \sphinxstyleemphasis{GetFEM} on other libraries are
\begin{itemize}
\item {} 
git client, automake, autoconf and libtool if you  want to build binaries
from git version to get the latest changes.

\item {} 
Python development files (Python.h etc.) and also the \sphinxstyleemphasis{numpy} and \sphinxstyleemphasis{scipy} packages if
you want to build the python interface.

\item {} 
sequential MUMPS package (direct solver for sparse matrices) if you want to use it instead of the SuperLU version distributed along with \sphinxstyleemphasis{GetFEM}.

\item {} 
Parallel MUMPS, METIS and MPI4PY packages if you want to use the MPI parallelized version of \sphinxstyleemphasis{GetFEM}.

\item {} 
qhull package for mesh generation and fictitious domain applications

\item {} 
BLAS and LAPACK packages

\end{itemize}

\sphinxstyleemphasis{GetFEM} C++ library can be build on its own or together with the Python, Scilab and/or Matlab interface.

You can also install the stable release of Getfem on linux distributions using the corresponding package management system.

More specific information on how to build Getfem C++ library can be found on the \sphinxhref{../download.html}{download and install} page.


\chapter{Basic Usage of \sphinxstyleemphasis{GetFEM}}
\label{\detokenize{tutorial/basic_usage:basic-usage-of-gf}}\label{\detokenize{tutorial/basic_usage:tut-bsic-usage}}\label{\detokenize{tutorial/basic_usage::doc}}
A \sphinxstyleemphasis{GetFEM} structure can be summarized as follows

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[scale=1.0]{{getfem_structure1}.png}
\end{figure}

A program using getfem will often have the following structure

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{n}{define} \PYG{n}{one} \PYG{o+ow}{or} \PYG{n}{more} \PYG{n}{Mesh}

\PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{n}{define} \PYG{n}{one} \PYG{o+ow}{or} \PYG{n}{more} \PYG{n}{MeshFem}

\PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{n}{define} \PYG{n}{one} \PYG{o+ow}{or} \PYG{n}{more} \PYG{n}{MeshIm}

\PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{n}{define} \PYG{n}{a} \PYG{n}{Model} \PYG{o+ow}{and} \PYG{n+nb}{set} \PYG{n}{it} \PYG{n}{up}\PYG{p}{:}

    \PYG{n}{Model}\PYG{o}{.}\PYG{n}{add\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{n}{MeshFem}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{some variable name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{Model}\PYG{o}{.}\PYG{n}{add\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{n}{MeshFem}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{another variable name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{Model}\PYG{o}{.}\PYG{n}{add\PYGZus{}fem\PYGZus{}data}\PYG{p}{(}\PYG{n}{MeshFem}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{some data name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{Model}\PYG{o}{.}\PYG{n}{add\PYGZus{}nonlinear\PYGZus{}generic\PYGZus{}assembly\PYGZus{}brick}\PYG{p}{(}\PYG{n}{MeshIm}\PYG{p}{,}
                            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{copy \PYGZam{} paste your PDE weak formulation here}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{MeshRegion}\PYG{p}{)}

    \PYG{n}{Model}\PYG{o}{.}\PYG{n}{solve}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{n}{options}\PYG{p}{)}
\end{sphinxVerbatim}

Note that instead of defining your pde terms with GWFL, the generic weak form language (see \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}gasm\sphinxhyphen{}high} for more details on the syntax of the weak form language), you can use predefined bricks for standard terms : generic elliptic term, linearized or finite strain elasticity, standard boundary conditions …


\chapter{Example of Thermo\sphinxhyphen{}elastic and electrical coupling (simple nonlinear coupled problem, model object, generic assembly, solve and visualization)}
\label{\detokenize{tutorial/thermo_coupling:example-of-thermo-elastic-and-electrical-coupling-simple-nonlinear-coupled-problem-model-object-generic-assembly-solve-and-visualization}}\label{\detokenize{tutorial/thermo_coupling:tut-thermo-elec-coupling}}\label{\detokenize{tutorial/thermo_coupling::doc}}
This example aims to present a simple example of a multiphysics problem with a nonlinear coupling of a displacement field, a temperature field and an electric potential field. It also aims to compare the use of the C++ library and the different interfaces. The corresponding demo files are present in the test directories of \sphinxstyleemphasis{GetFEM} (\sphinxtitleref{tests/}, \sphinxtitleref{interface/tests/python}, \sphinxtitleref{interface/scr/scilab/demos} and \sphinxtitleref{interface/tests/matlab}).


\section{The problem setting}
\label{\detokenize{tutorial/thermo_coupling:the-problem-setting}}
Let \(\Omega \subset \rm I\hspace{-0.15em}R^2\) be the reference configuration of a 2D plate (see the geometry {\hyperref[\detokenize{tutorial/thermo_coupling:tut-fig-meshthermo}]{\sphinxcrossref{\DUrole{std,std-ref}{here}}}}) of thickness \(\varepsilon\) submitted to external forces, electric potential and heating. We will denote by  \(\theta : \Omega \rightarrow \rm I\hspace{-0.15em}R\) the temperature field (in °C),  \(V : \Omega \rightarrow \rm I\hspace{-0.15em}R\) the electric potential field and \(u : \Omega \rightarrow \rm I\hspace{-0.15em}R^2\) the membrane displacement field.


\subsection{Thermal problem}
\label{\detokenize{tutorial/thermo_coupling:thermal-problem}}
The lateral faces of the plates are supposed to be in thermal insulation since the front and back faces of the plate are supposed to be in thermal exchange with the air (supposed at 20 °C) with a heat transfer coefficient \(D\).

The equation on the temperature \(\theta\) and boundary condition can be written as follows:
\begin{equation*}
\begin{split}\left\{\begin{array}{l}
-\mbox{div}(\varepsilon\kappa(\nabla \theta)) + 2D(\theta - T_0) - \varepsilon\sigma|\nabla V|^2 = 0 ~~ \mbox{ in } \Omega, \\
\kappa\nabla \theta \cdot n = 0 ~~ \mbox{ on } \partial \Omega,
\end{array} \right.\end{split}
\end{equation*}
where the thermal conductivity is designed by \(\kappa\), \(T_0\) is the temperature of the air, \(\partial \Omega\) the boundary of the domain \(\Omega\) and \(n\) the outward unit normal vector to \(\Omega\) on \(\partial \Omega\).

The term \(\sigma|\nabla V|^2\) is a nonlinear coupling term corresponding to the Joule heating term, where \(\sigma\) is the electrical conductivity.


\subsection{Electric potential problem}
\label{\detokenize{tutorial/thermo_coupling:electric-potential-problem}}
We consider a potential difference of \(0.1V\) between the right and left lateral face of the plate. The other faces are considered electrically insulated. The equation for the electric potential reads as
\begin{equation*}
\begin{split} \left\{\begin{array}{l}
-\mbox{div}(\varepsilon\sigma(\nabla V)) = 0 ~~ \mbox{ in } \Omega, \\
\sigma\nabla V \cdot n = 0 ~~ \mbox{ on the top an bottom lateral faces}, \\
V = 0 ~~ \mbox{ on the right lateral face}, \\
V = 0.1 ~~ \mbox{ on the left lateral face}, \\
\end{array} \right.\end{split}
\end{equation*}
where \(\sigma\) is still the electrical conductivity. Moreover, we consider that \(\sigma\) depends on the temperature as follows:
\begin{equation*}
\begin{split}\sigma = \dfrac{1}{\rho_0(1+\alpha(\theta - T_0))},\end{split}
\end{equation*}
where \(T_0\) is a reference temperature (air temperature here), \(\rho_0\) the resistance temperature coefficient at \(T_0\) and \(\alpha\) a second resistance temperature coefficient.


\subsection{Deformation problem}
\label{\detokenize{tutorial/thermo_coupling:deformation-problem}}
We consider the membrane small deformation of the plate under a force applied on the right lateral face and influenced by the heating of the plate. The displacement \(u\) will be solution of the following problem (linearized elasticity):
\begin{equation*}
\begin{split} \left\{\begin{array}{l}
-\mbox{div}(\bar{\sigma}(u)) = 0 ~~ \mbox{ in } \Omega, \\
\bar{\sigma}\ n = 0 ~~ \mbox{ on the top an bottom lateral faces}, \\
\bar{\sigma}\ n = F ~~ \mbox{ on the right lateral face}, \\
u = 0 ~~ \mbox{ on the left lateral face},
\end{array} \right.\end{split}
\end{equation*}
where \(F\) is the force density applied on the right lateral boundary and \(\bar{\sigma}(u)\) is the Cauchy stress tensor defined by
\begin{equation*}
\begin{split}\bar{\sigma}(u) = \lambda^* \mbox{div}(u) I + 2\mu \bar{\varepsilon}(u) + \beta(T_0-\theta) I,\end{split}
\end{equation*}
\(\bar{\varepsilon}(u) = (\nabla u + (\nabla u)^T)/2\) being the linearized strain tensor, \(I\) the identity second order tensor and \(\lambda^*, \mu\) being the Lamé coefficients defined  by
\begin{equation*}
\begin{split}&\lambda = \dfrac{E\nu}{(1+\nu)(1-2\nu)}, \\
&\mu = \dfrac{E}{2(1+\nu)}, \\
&\lambda^* = \dfrac{2\lambda\mu}{\lambda+2*\mu},\end{split}
\end{equation*}
from \(E\) the Young modulus and \(\nu\) the Poisson ratio of the material.

The term \(\beta(T_0-\theta) I\) corresponds to the thermal expansion term, where \(\beta = \alpha_{th} E/(1-2\nu)\), \(\alpha_{th}\) being the thermal expansion coefficient.


\section{The weak formulation}
\label{\detokenize{tutorial/thermo_coupling:the-weak-formulation}}
An important step is to obtain the weak formulation of the coupled system of equations. This is a crucial step since the finite element formulation is based on the weak formulation (Galerkin approximation) and the weak formulation is the only one which can give us the expression of the terms to be added.

Weak formulation of each partial differential equation is obtained by multiplying the equation with a test function corresponding to the main unknown satisfying homogeneous Dirichlet conditions where the main unknown satisfies a Dirichlet condition, then integrating over the domain \(\Omega\) and performing some integrations by parts (using Green’s formula). The weak formulation of the system of partial differential equations reads:
\begin{equation*}
\begin{split}&\mbox{Find } \theta, V, u \mbox{ with } V = 0.1, u = 0 \mbox{ on the left face}, V = 0 \mbox{ on the right face}, \\
& \int_{\Omega} \varepsilon\kappa\nabla\theta\cdot\nabla\delta_{\theta} + 2D\theta\delta_{\theta}d\Omega = \int_{\Omega} (2DT_0 + \varepsilon\sigma|\nabla V|^2)\delta_{\theta} d\Omega ~~~\mbox{ for all } \delta_{\theta}, \\
& \int_{\Omega} \varepsilon\sigma\nabla V\cdot\nabla\delta_V = 0 d\Omega ~~~ \mbox{ for all } \delta_V \mbox{ satisfying } \delta_V = 0 \mbox{ on the left and right faces}, \\
& \int_{\Omega} \bar{\sigma}(u):\bar{\varepsilon}(\delta_u)d\Omega = \int_{\Gamma_N} F\cdot \delta_u d\Gamma ~~~ \mbox{ for all } \delta_{u} \mbox{ satisfying } \delta_u = 0 \mbox{ on the left face},\end{split}
\end{equation*}
where \(\delta_{\theta}, \delta_V, \delta_u\) are the test functions corresponding to \(\theta, V, u\), respectively, \(\Gamma_N\) denotes the right boundary where the density of force \(F\) is applied and \(\bar{\sigma}:\bar{\varepsilon}\) is the Frobenius scalar product between second order tensors.


\section{Implementation in C++ and with the interface}
\label{\detokenize{tutorial/thermo_coupling:implementation-in-c-and-with-the-interface}}
Let us now make a detailed presentation of the use of \sphinxstyleemphasis{GetFEM} to approximate the problem. We build simultaneously a C++, Python, Scilab and Matlab program. For Matlab and Scilab programs, we will not use the oriented object commands (see \DUrole{xref,std,std-ref}{mlab\sphinxhyphen{}oocmd} how to use them)


\subsection{Initialization}
\label{\detokenize{tutorial/thermo_coupling:initialization}}
First, in C++, ones has to include a certain number of headers for the model object, the generic assembly, the linear algebra interface (Gmm++), the experimental mesher and the export facilities. For Python, this is simpler, \sphinxstyleemphasis{GetFEM} can be imported globally (numpy has also to be imported). For Scilab, the library has first to be loaded in the Scilab console (this is not described here) and for Matlab, nothing is necessary, except a \sphinxtitleref{gf\_workspace(‘clear all’)} which allows to clear all \sphinxstyleemphasis{GetFEM} variables.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{include} \PYG{c+cpf}{\PYGZdq{}getfem/getfem\PYGZus{}model\PYGZus{}solvers.h\PYGZdq{}}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{include} \PYG{c+cpf}{\PYGZdq{}getfem/getfem\PYGZus{}export.h\PYGZdq{}}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{include} \PYG{c+cpf}{\PYGZdq{}gmm/gmm.h\PYGZdq{}}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{include} \PYG{c+cpf}{\PYGZdq{}getfem/getfem\PYGZus{}mesher.h\PYGZdq{}}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{include} \PYG{c+cpf}{\PYGZdq{}getfem/getfem\PYGZus{}generic\PYGZus{}assembly.h\PYGZdq{}}

\PYG{k}{using} \PYG{n}{bgeot}\PYG{o}{:}\PYG{o}{:}\PYG{n}{size\PYGZus{}type}\PYG{p}{;}
\PYG{k}{using} \PYG{n}{bgeot}\PYG{o}{:}\PYG{o}{:}\PYG{n}{base\PYGZus{}node}\PYG{p}{;}
\PYG{k}{using} \PYG{n}{bgeot}\PYG{o}{:}\PYG{o}{:}\PYG{n}{base\PYGZus{}small\PYGZus{}vector}\PYG{p}{;}
\PYG{k}{typedef} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{model\PYGZus{}real\PYGZus{}plain\PYGZus{}vector} \PYG{n}{plain\PYGZus{}vector}\PYG{p}{;}

\PYG{k+kt}{int} \PYG{n+nf}{main}\PYG{p}{(}\PYG{k+kt}{void}\PYG{p}{)} \PYG{p}{\PYGZob{}}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{getfem} \PYG{k}{as} \PYG{n+nn}{gf}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gf\PYGZus{}workspace}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{clear all\PYGZsq{}}\PYG{p}{)}\PYG{p}{;} \PYG{o}{/}\PYG{o}{/} \PYG{n}{In} \PYG{k}{case} \PYG{n}{of} \PYG{n}{multiple} \PYG{n}{runs}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gf\PYGZus{}workspace}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{clear all\PYGZsq{}}\PYG{p}{)}\PYG{p}{;} \PYG{c}{\PYGZpc{} In case of multiple runs}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Parameters of the model}
\label{\detokenize{tutorial/thermo_coupling:parameters-of-the-model}}
Let us now define the different physical and numerical parameters of the problem. For script languages (Python, Scilab and Matlab) there is no differences.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{k+kt}{double} \PYG{n}{epsilon} \PYG{o}{=} \PYG{l+m+mf}{1.}\PYG{p}{;} \PYG{c+c1}{// Thickness of the plate (cm)}
\PYG{k+kt}{double} \PYG{n}{E} \PYG{o}{=} \PYG{l+m+mf}{21E6}\PYG{p}{;}     \PYG{c+c1}{// Young Modulus (N/cm\PYGZca{}2)}
\PYG{k+kt}{double} \PYG{n}{nu} \PYG{o}{=} \PYG{l+m+mf}{0.3}\PYG{p}{;}     \PYG{c+c1}{// Poisson ratio}
\PYG{k+kt}{double} \PYG{n}{clambda} \PYG{o}{=} \PYG{n}{E}\PYG{o}{*}\PYG{n}{nu}\PYG{o}{/}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{nu}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{nu}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{k+kt}{double} \PYG{n}{cmu} \PYG{o}{=} \PYG{n}{E}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{nu}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{k+kt}{double} \PYG{n}{clambdastar} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{clambda}\PYG{o}{*}\PYG{n}{cmu}\PYG{o}{/}\PYG{p}{(}\PYG{n}{clambda}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{cmu}\PYG{p}{)}\PYG{p}{;}
\PYG{k+kt}{double} \PYG{n}{F} \PYG{o}{=} \PYG{l+m+mf}{100E2}\PYG{p}{;}    \PYG{c+c1}{// Force density at the right boundary (N/cm\PYGZca{}2)}
\PYG{k+kt}{double} \PYG{n}{kappa} \PYG{o}{=} \PYG{l+m+mf}{4.}\PYG{p}{;}   \PYG{c+c1}{// Thermal conductivity (W/(cm K))}
\PYG{k+kt}{double} \PYG{n}{D} \PYG{o}{=} \PYG{l+m+mf}{10.}\PYG{p}{;}      \PYG{c+c1}{// Heat transfer coefficient (W/(K cm\PYGZca{}2))}
\PYG{k+kt}{double} \PYG{n}{air\PYGZus{}temp} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{;}\PYG{c+c1}{// Temperature of the air in oC.}
\PYG{k+kt}{double} \PYG{n}{alpha\PYGZus{}th} \PYG{o}{=} \PYG{l+m+mf}{16.6E\PYGZhy{}6}\PYG{p}{;} \PYG{c+c1}{// Thermal expansion coefficient (/K)}
\PYG{k+kt}{double} \PYG{n}{T0} \PYG{o}{=} \PYG{l+m+mf}{20.}\PYG{p}{;}     \PYG{c+c1}{// Reference temperature in oC}
\PYG{k+kt}{double} \PYG{n}{rho\PYGZus{}0} \PYG{o}{=} \PYG{l+m+mf}{1.754E\PYGZhy{}8}\PYG{p}{;} \PYG{c+c1}{// Resistance temperature coefficient at T0}
\PYG{k+kt}{double} \PYG{n}{alpha} \PYG{o}{=} \PYG{l+m+mf}{0.0039}\PYG{p}{;} \PYG{c+c1}{// Second resistance temperature coefficient}

\PYG{k+kt}{double} \PYG{n}{h} \PYG{o}{=} \PYG{l+m+mf}{2.}        \PYG{c+c1}{// Approximate mesh size}
\PYG{n}{bgeot}\PYG{o}{:}\PYG{o}{:}\PYG{n}{dim\PYGZus{}type} \PYG{n}{elements\PYGZus{}degree} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{p}{;} \PYG{c+c1}{// Degree of the finite element methods}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Scripts}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{epsilon} \PYG{o}{=} \PYG{l+m+mf}{1.}\PYG{p}{;} \PYG{n}{E} \PYG{o}{=} \PYG{l+m+mf}{21E6}\PYG{p}{;} \PYG{n}{nu} \PYG{o}{=} \PYG{l+m+mf}{0.3}\PYG{p}{;}
\PYG{n}{clambda} \PYG{o}{=} \PYG{n}{E}\PYG{o}{*}\PYG{n}{nu}\PYG{o}{/}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{nu}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{nu}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{cmu} \PYG{o}{=} \PYG{n}{E}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{nu}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{clambdastar} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{clambda}\PYG{o}{*}\PYG{n}{cmu}\PYG{o}{/}\PYG{p}{(}\PYG{n}{clambda}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{cmu}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{F} \PYG{o}{=} \PYG{l+m+mf}{100E2}\PYG{p}{;} \PYG{n}{kappa} \PYG{o}{=} \PYG{l+m+mf}{4.}\PYG{p}{;} \PYG{n}{D} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{n}{air\PYGZus{}temp} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{;} \PYG{n}{alpha\PYGZus{}th} \PYG{o}{=} \PYG{l+m+mf}{16.6E\PYGZhy{}6}\PYG{p}{;}
\PYG{n}{T0} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{;} \PYG{n}{rho\PYGZus{}0} \PYG{o}{=} \PYG{l+m+mf}{1.754E\PYGZhy{}8}\PYG{p}{;}
\PYG{n}{alpha} \PYG{o}{=} \PYG{l+m+mf}{0.0039}\PYG{p}{;}

\PYG{n}{h} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{p}{;} \PYG{n}{elements\PYGZus{}degree} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Mesh generation}
\label{\detokenize{tutorial/thermo_coupling:mesh-generation}}
\sphinxstyleemphasis{GetFEM} has some limited meshing facilities which are described here. We are going to use them. However, there is no guaranty of the quality and conformity of the obtained mesh, so it is better to verify the mesh if you use \sphinxstyleemphasis{GetFEM} meshing facilities. You can also use external meshers (GiD or Gmsh for instance) and import them (see \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}load\_save\_mesh}).

The geometry of the domain is supposed to be a rectangle with three circular holes (see {\hyperref[\detokenize{tutorial/thermo_coupling:tut-fig-meshthermo}]{\sphinxcrossref{\DUrole{std,std-ref}{The obtained mesh.}}}}). The geometry is described thanks to some geometrical primitives and union/setminus operations (see \sphinxcode{\sphinxupquote{src/getfem/getfem\_mesher.h}} file). In the following, \sphinxtitleref{h} stands for the mesh size and \sphinxtitleref{2} is the degree of the mesh (this means that the transformation is of degree two, we used curved edges).


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh} \PYG{n}{mesh}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{pmesher\PYGZus{}signed\PYGZus{}distance}
\PYG{n}{mo1} \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{new\PYGZus{}mesher\PYGZus{}rectangle}\PYG{p}{(}\PYG{n}{base\PYGZus{}node}\PYG{p}{(}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{l+m+mf}{0.}\PYG{p}{)}\PYG{p}{,} \PYG{n}{base\PYGZus{}node}\PYG{p}{(}\PYG{l+m+mf}{100.}\PYG{p}{,} \PYG{l+m+mf}{25.}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}
\PYG{n}{mo2} \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{new\PYGZus{}mesher\PYGZus{}ball}\PYG{p}{(}\PYG{n}{base\PYGZus{}node}\PYG{p}{(}\PYG{l+m+mf}{25.}\PYG{p}{,} \PYG{l+m+mf}{12.5}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mf}{8.}\PYG{p}{)}\PYG{p}{,}
\PYG{n}{mo3} \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{new\PYGZus{}mesher\PYGZus{}ball}\PYG{p}{(}\PYG{n}{base\PYGZus{}node}\PYG{p}{(}\PYG{l+m+mf}{50.}\PYG{p}{,} \PYG{l+m+mf}{12.5}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mf}{8.}\PYG{p}{)}\PYG{p}{,}
\PYG{n}{mo4} \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{new\PYGZus{}mesher\PYGZus{}ball}\PYG{p}{(}\PYG{n}{base\PYGZus{}node}\PYG{p}{(}\PYG{l+m+mf}{75.}\PYG{p}{,} \PYG{l+m+mf}{12.5}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mf}{8.}\PYG{p}{)}\PYG{p}{,}
\PYG{n}{mo5} \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{new\PYGZus{}mesher\PYGZus{}union}\PYG{p}{(}\PYG{n}{mo2}\PYG{p}{,} \PYG{n}{mo3}\PYG{p}{,} \PYG{n}{mo4}\PYG{p}{)}\PYG{p}{,}
\PYG{n}{mo} \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{new\PYGZus{}mesher\PYGZus{}setminus}\PYG{p}{(}\PYG{n}{mo1}\PYG{p}{,} \PYG{n}{mo5}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{std}\PYG{o}{:}\PYG{o}{:}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{base\PYGZus{}node}\PYG{o}{\PYGZgt{}} \PYG{n}{fixed}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{build\PYGZus{}mesh}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{n}{mo}\PYG{p}{,} \PYG{n}{h}\PYG{p}{,} \PYG{n}{fixed}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{mo1} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MesherObject}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rectangle}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{l+m+mf}{0.}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{100.}\PYG{p}{,} \PYG{l+m+mf}{25.}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{mo2} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MesherObject}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ball}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{25.}\PYG{p}{,} \PYG{l+m+mf}{12.5}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{8.}\PYG{p}{)}
\PYG{n}{mo3} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MesherObject}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ball}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{50.}\PYG{p}{,} \PYG{l+m+mf}{12.5}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{8.}\PYG{p}{)}
\PYG{n}{mo4} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MesherObject}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ball}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{75.}\PYG{p}{,} \PYG{l+m+mf}{12.5}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{8.}\PYG{p}{)}
\PYG{n}{mo5} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MesherObject}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{union}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mo2}\PYG{p}{,} \PYG{n}{mo3}\PYG{p}{,} \PYG{n}{mo4}\PYG{p}{)}
\PYG{n}{mo}  \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MesherObject}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{set minus}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mo1}\PYG{p}{,} \PYG{n}{mo5}\PYG{p}{)}

\PYG{n}{mesh} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{Mesh}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{generate}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mo}\PYG{p}{,} \PYG{n}{h}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{mo1} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesher\PYGZus{}object}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{rectangle\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{100} \PYG{l+m+mi}{25}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mo2} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesher\PYGZus{}object}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ball\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{25} \PYG{l+m+mf}{12.5}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mo3} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesher\PYGZus{}object}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ball\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{50} \PYG{l+m+mf}{12.5}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mo4} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesher\PYGZus{}object}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ball\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{75} \PYG{l+m+mf}{12.5}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mo5} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesher\PYGZus{}object}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{union\PYGZsq{}}\PYG{p}{,} \PYG{n}{mo2}\PYG{p}{,} \PYG{n}{mo3}\PYG{p}{,} \PYG{n}{mo4}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mo}  \PYG{l+s}{=} \PYG{l+s}{gf\PYGZus{}mesher\PYGZus{}object(}\PYG{l+s}{\PYGZsq{}set minus\PYGZsq{}}\PYG{l+s}{,} \PYG{l+s}{mo1,} \PYG{l+s}{mo5)}\PYG{p}{;}

\PYG{n}{mesh} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{generate\PYGZsq{}}\PYG{p}{,} \PYG{n}{mo}\PYG{p}{,} \PYG{n}{h}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{mo1} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesher\PYGZus{}object}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{rectangle\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{100} \PYG{l+m+mi}{25}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mo2} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesher\PYGZus{}object}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ball\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{25} \PYG{l+m+mf}{12.5}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mo3} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesher\PYGZus{}object}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ball\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{50} \PYG{l+m+mf}{12.5}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mo4} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesher\PYGZus{}object}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ball\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{75} \PYG{l+m+mf}{12.5}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mo5} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesher\PYGZus{}object}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{union\PYGZsq{}}\PYG{p}{,} \PYG{n}{mo2}\PYG{p}{,} \PYG{n}{mo3}\PYG{p}{,} \PYG{n}{mo4}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mo}  \PYG{l+s}{=} \PYG{l+s}{gf\PYGZus{}mesher\PYGZus{}object(}\PYG{l+s}{\PYGZsq{}set minus\PYGZsq{}}\PYG{l+s}{,} \PYG{l+s}{mo1,} \PYG{l+s}{mo5)}\PYG{p}{;}

\PYG{n}{mesh} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{generate\PYGZsq{}}\PYG{p}{,} \PYG{n}{mo}\PYG{p}{,} \PYG{n}{h}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[scale=1.0]{{mesh_thermo}.png}
\caption{The obtained mesh.}\label{\detokenize{tutorial/thermo_coupling:id3}}\label{\detokenize{tutorial/thermo_coupling:tut-fig-meshthermo}}\end{figure}

\clearpage


\subsection{Boundary selection}
\label{\detokenize{tutorial/thermo_coupling:boundary-selection}}
Since we have different boundary conditions on the different parts of the boundary, we have to number the different parts of the boundary (in the hole, thermal and electrical insulation together with a stress free boundary conditions are assumed). Thus, we have to select the element faces on the mesh and define mesh regions (see \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}mesh\_regions}) 1, 2, 3, 4 to be the right boundary, the left one, the top one and the bottom one respectively. These boundary numbers will be used in the model bricks.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}region} \PYG{n}{border\PYGZus{}faces}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{outer\PYGZus{}faces\PYGZus{}of\PYGZus{}mesh}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{n}{border\PYGZus{}faces}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}region} \PYG{n}{fb1}
  \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{select\PYGZus{}faces\PYGZus{}in\PYGZus{}box}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{n}{border\PYGZus{}faces}\PYG{p}{,} \PYG{n}{base\PYGZus{}node}\PYG{p}{(}\PYG{l+m+mf}{1.}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{p}{)}\PYG{p}{,}
                 \PYG{n}{base\PYGZus{}node}\PYG{p}{(}\PYG{l+m+mf}{99.}\PYG{p}{,} \PYG{l+m+mf}{24.}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}region} \PYG{n}{fb2}
  \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{select\PYGZus{}faces\PYGZus{}of\PYGZus{}normal}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{n}{border\PYGZus{}faces}\PYG{p}{,}
                     \PYG{n}{base\PYGZus{}small\PYGZus{}vector}\PYG{p}{(} \PYG{l+m+mf}{1.}\PYG{p}{,} \PYG{l+m+mf}{0.}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}region} \PYG{n}{fb3}
  \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{select\PYGZus{}faces\PYGZus{}of\PYGZus{}normal}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{n}{border\PYGZus{}faces}\PYG{p}{,}
                     \PYG{n}{base\PYGZus{}small\PYGZus{}vector}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.}\PYG{p}{,} \PYG{l+m+mf}{0.}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}region} \PYG{n}{fb4}
  \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{select\PYGZus{}faces\PYGZus{}of\PYGZus{}normal}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{n}{border\PYGZus{}faces}\PYG{p}{,}
                     \PYG{n}{base\PYGZus{}small\PYGZus{}vector}\PYG{p}{(}\PYG{l+m+mf}{0.}\PYG{p}{,}  \PYG{l+m+mf}{1.}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}region} \PYG{n}{fb5}
  \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{select\PYGZus{}faces\PYGZus{}of\PYGZus{}normal}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{n}{border\PYGZus{}faces}\PYG{p}{,}
                     \PYG{n}{base\PYGZus{}small\PYGZus{}vector}\PYG{p}{(}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{size\PYGZus{}type} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{TOP\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{;}
\PYG{n}{mesh}\PYG{p}{.}\PYG{n}{region}\PYG{p}{(} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{)} \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}region}\PYG{o}{:}\PYG{o}{:}\PYG{n}{subtract}\PYG{p}{(}\PYG{n}{fb2}\PYG{p}{,} \PYG{n}{fb1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mesh}\PYG{p}{.}\PYG{n}{region}\PYG{p}{(}  \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{)} \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}region}\PYG{o}{:}\PYG{o}{:}\PYG{n}{subtract}\PYG{p}{(}\PYG{n}{fb3}\PYG{p}{,} \PYG{n}{fb1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mesh}\PYG{p}{.}\PYG{n}{region}\PYG{p}{(}   \PYG{n}{TOP\PYGZus{}BOUND}\PYG{p}{)} \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}region}\PYG{o}{:}\PYG{o}{:}\PYG{n}{subtract}\PYG{p}{(}\PYG{n}{fb4}\PYG{p}{,} \PYG{n}{fb1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mesh}\PYG{p}{.}\PYG{n}{region}\PYG{p}{(}\PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{)} \PYG{o}{=} \PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}region}\PYG{o}{:}\PYG{o}{:}\PYG{n}{subtract}\PYG{p}{(}\PYG{n}{fb5}\PYG{p}{,} \PYG{n}{fb1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{fb1} \PYG{o}{=} \PYG{n}{mesh}\PYG{o}{.}\PYG{n}{outer\PYGZus{}faces\PYGZus{}in\PYGZus{}box}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1.}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{99.}\PYG{p}{,} \PYG{l+m+mf}{24.}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{fb2} \PYG{o}{=} \PYG{n}{mesh}\PYG{o}{.}\PYG{n}{outer\PYGZus{}faces\PYGZus{}with\PYGZus{}direction}\PYG{p}{(}\PYG{p}{[} \PYG{l+m+mf}{1.}\PYG{p}{,} \PYG{l+m+mf}{0.}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}
\PYG{n}{fb3} \PYG{o}{=} \PYG{n}{mesh}\PYG{o}{.}\PYG{n}{outer\PYGZus{}faces\PYGZus{}with\PYGZus{}direction}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.}\PYG{p}{,} \PYG{l+m+mf}{0.}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}
\PYG{n}{fb4} \PYG{o}{=} \PYG{n}{mesh}\PYG{o}{.}\PYG{n}{outer\PYGZus{}faces\PYGZus{}with\PYGZus{}direction}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.}\PYG{p}{,}  \PYG{l+m+mf}{1.}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}
\PYG{n}{fb5} \PYG{o}{=} \PYG{n}{mesh}\PYG{o}{.}\PYG{n}{outer\PYGZus{}faces\PYGZus{}with\PYGZus{}direction}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}

\PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{;} \PYG{n}{TOP\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{;} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{;} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{;}

\PYG{n}{mesh}\PYG{o}{.}\PYG{n}{set\PYGZus{}region}\PYG{p}{(} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb2}\PYG{p}{)}
\PYG{n}{mesh}\PYG{o}{.}\PYG{n}{set\PYGZus{}region}\PYG{p}{(}  \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb3}\PYG{p}{)}
\PYG{n}{mesh}\PYG{o}{.}\PYG{n}{set\PYGZus{}region}\PYG{p}{(}   \PYG{n}{TOP\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb4}\PYG{p}{)}
\PYG{n}{mesh}\PYG{o}{.}\PYG{n}{set\PYGZus{}region}\PYG{p}{(}\PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb5}\PYG{p}{)}
\PYG{n}{mesh}\PYG{o}{.}\PYG{n}{set\PYGZus{}region}\PYG{p}{(}  \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb1}\PYG{p}{)}
\PYG{n}{mesh}\PYG{o}{.}\PYG{n}{region\PYGZus{}subtract}\PYG{p}{(} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}
\PYG{n}{mesh}\PYG{o}{.}\PYG{n}{region\PYGZus{}subtract}\PYG{p}{(}  \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}
\PYG{n}{mesh}\PYG{o}{.}\PYG{n}{region\PYGZus{}subtract}\PYG{p}{(}   \PYG{n}{TOP\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}
\PYG{n}{mesh}\PYG{o}{.}\PYG{n}{region\PYGZus{}subtract}\PYG{p}{(}\PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{fb1} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}get}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{outer faces in box\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{99} \PYG{l+m+mi}{24}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{fb2} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}get}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{outer faces with direction\PYGZsq{}}\PYG{p}{,} \PYG{p}{[} \PYG{l+m+mi}{1} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{fb3} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}get}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{outer faces with direction\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{fb4} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}get}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{outer faces with direction\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0}  \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{fb5} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}get}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{outer faces with direction\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{=}\PYG{l+m+mi}{2}\PYG{p}{;} \PYG{n}{TOP\PYGZus{}BOUND}\PYG{p}{=}\PYG{l+m+mi}{3}\PYG{p}{;} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{=}\PYG{l+m+mi}{4}\PYG{p}{;} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{=}\PYG{l+m+mi}{5}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region\PYGZsq{}}\PYG{p}{,}  \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region\PYGZsq{}}\PYG{p}{,}   \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb3}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region\PYGZsq{}}\PYG{p}{,}    \PYG{n}{TOP\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb4}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region\PYGZsq{}}\PYG{p}{,} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb5}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region\PYGZsq{}}\PYG{p}{,}   \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region subtract\PYGZsq{}}\PYG{p}{,}  \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region subtract\PYGZsq{}}\PYG{p}{,}   \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region subtract\PYGZsq{}}\PYG{p}{,}    \PYG{n}{TOP\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region subtract\PYGZsq{}}\PYG{p}{,} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{fb1} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}get}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{outer faces in box\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{99} \PYG{l+m+mi}{24}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{fb2} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}get}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{outer faces with direction\PYGZsq{}}\PYG{p}{,} \PYG{p}{[} \PYG{l+m+mi}{1} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{fb3} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}get}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{outer faces with direction\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{fb4} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}get}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{outer faces with direction\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0}  \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{fb5} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}get}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{outer faces with direction\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{=}\PYG{l+m+mi}{2}\PYG{p}{;} \PYG{n}{TOP\PYGZus{}BOUND}\PYG{p}{=}\PYG{l+m+mi}{3}\PYG{p}{;} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{=}\PYG{l+m+mi}{4}\PYG{p}{;} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{=}\PYG{l+m+mi}{5}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region\PYGZsq{}}\PYG{p}{,}  \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region\PYGZsq{}}\PYG{p}{,}   \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb3}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region\PYGZsq{}}\PYG{p}{,}    \PYG{n}{TOP\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb4}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region\PYGZsq{}}\PYG{p}{,} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb5}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region\PYGZsq{}}\PYG{p}{,}   \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region subtract\PYGZsq{}}\PYG{p}{,}  \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region subtract\PYGZsq{}}\PYG{p}{,}   \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region subtract\PYGZsq{}}\PYG{p}{,}    \PYG{n}{TOP\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}set}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{region subtract\PYGZsq{}}\PYG{p}{,} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Mesh draw}
\label{\detokenize{tutorial/thermo_coupling:mesh-draw}}
In order to preview the mesh and to control its validity, the following instructions can be used:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{vtk\PYGZus{}export} \PYG{n}{exp}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{mesh.vtk}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n+nb}{false}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{exp}\PYG{p}{.}\PYG{n}{exporting}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{exp}\PYG{p}{.}\PYG{n}{write\PYGZus{}mesh}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{c+c1}{// You can view the mesh for instance with}
\PYG{c+c1}{// mayavi2 \PYGZhy{}d mesh.vtk \PYGZhy{}f ExtractEdges \PYGZhy{}m Surface}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{mesh}\PYG{o}{.}\PYG{n}{export\PYGZus{}to\PYGZus{}vtk}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mesh.vtk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{c+c1}{\PYGZsh{} You can view the mesh for instance with}
\PYG{c+c1}{\PYGZsh{} mayavi2 \PYGZhy{}d mesh.vtk \PYGZhy{}f ExtractEdges \PYGZhy{}m Surface}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{scf}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}plot\PYGZus{}mesh}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{refine\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{curved\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{on\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{regions\PYGZsq{}}\PYG{p}{,} \PYG{c}{...}
             \PYG{p}{[}\PYG{n}{RIGHT\PYGZus{}BOUND} \PYG{n}{LEFT\PYGZus{}BOUND} \PYG{n}{TOP\PYGZus{}BOUND} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Mesh\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{sleep}\PYG{p}{(}\PYG{l+m+mi}{1000}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gf\PYGZus{}plot\PYGZus{}mesh}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{refine\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{curved\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{on\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{regions\PYGZsq{}}\PYG{p}{,} \PYG{c}{...}
             \PYG{p}{[}\PYG{n}{RIGHT\PYGZus{}BOUND} \PYG{n}{LEFT\PYGZus{}BOUND} \PYG{n}{TOP\PYGZus{}BOUND} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Mesh\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{pause}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

In C++ and with the Python interface, an external graphical post\sphinxhyphen{}processor has to be used (for instance, gmsh, Mayavi2 or Paraview). With Scilab and Matlab interfaces, the internal plot facilities can be used (see the result {\hyperref[\detokenize{tutorial/thermo_coupling:tut-fig-meshthermo}]{\sphinxcrossref{\DUrole{std,std-ref}{The obtained mesh.}}}}).


\subsection{Definition of finite element methods and integration method}
\label{\detokenize{tutorial/thermo_coupling:definition-of-finite-element-methods-and-integration-method}}
We will define three finite element methods. The first one, \sphinxtitleref{mfu} is to approximate the displacement field. This is a vector field. This is defined in C++ by

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}fem} \PYG{n}{mfu}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mfu}\PYG{p}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}finite\PYGZus{}element}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

where the \sphinxtitleref{2} stands for the dimension of the vector field. The second line sets the finite element used. \sphinxtitleref{classical\_finite\_element} means a continuous Lagrange element and remember that \sphinxtitleref{elements\_degree} has been set to \sphinxtitleref{2} which means that we will use quadratic (isoparametric) elements.

There is a wide choice of pre\sphinxhyphen{}existing finite element methods in \sphinxstyleemphasis{GetFEM}, see \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}appendixa}. However, Lagrange finite element methods are the most used in practice.

The second finite element method is a scalar one, \sphinxtitleref{mft} with which we will approximate both the temperature field and the electric potential field. A single finite element method can serve to approximate an arbitrary number of finite element variables.

The third finite element method is a discontinuous scalar Lagrange one which will allow us to interpolate the derivative of one of the variables (for instance to interpolate the Von Mises stress).

The last thing to define is an integration method \sphinxtitleref{mim}. There is no default integration method in \sphinxstyleemphasis{GetFEM} so this is mandatory to define an integration method. Of course, the order of the integration method have to be chosen sufficient to make a convenient integration of the selected finite element method. Here, the square of \sphinxtitleref{elements\_degree} is sufficient.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}fem} \PYG{n}{mfu}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mfu}\PYG{p}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}finite\PYGZus{}element}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}fem} \PYG{n}{mft}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mft}\PYG{p}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}finite\PYGZus{}element}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}fem} \PYG{n}{mfvm}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mfvm}\PYG{p}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}discontinuous\PYGZus{}finite\PYGZus{}element}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{mesh\PYGZus{}im}  \PYG{n}{mim}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mim}\PYG{p}{.}\PYG{n}{set\PYGZus{}integration\PYGZus{}method}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{mfu} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshFem}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{mfu}\PYG{o}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}fem}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}
\PYG{n}{mft} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshFem}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{mft}\PYG{o}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}fem}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}
\PYG{n}{mfvm} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshFem}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{mfvm}\PYG{o}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}discontinuous\PYGZus{}fem}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}
\PYG{n}{mim} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshIm}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{mfu} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem\PYGZus{}set}\PYG{p}{(}\PYG{n}{mfu}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{classical fem\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mft} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem\PYGZus{}set}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{classical fem\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mfvm} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem\PYGZus{}set}\PYG{p}{(}\PYG{n}{mfvm}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{classical discontinuous fem\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mim} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}im}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{mfu} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem\PYGZus{}set}\PYG{p}{(}\PYG{n}{mfu}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{classical fem\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mft} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem\PYGZus{}set}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{classical fem\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mfvm} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem\PYGZus{}set}\PYG{p}{(}\PYG{n}{mfvm}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{classical discontinuous fem\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mim} \PYG{p}{=} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}im}\PYG{p}{(}\PYG{n}{mesh}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Model definition}
\label{\detokenize{tutorial/thermo_coupling:model-definition}}
The model object in \sphinxstyleemphasis{GetFEM} gather the variables of the models (the unknowns), the data and what is called the model bricks. The model bricks are some parts of the model (linear or nonlinear terms) applied on a single variable or linking several variables. They are used to make the assembly of the (tangent) linear system (see \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}model\sphinxhyphen{}object} for more details).

This is not strictly mandatory to use the model object since one may use directly the assembly procedures and build by it own the (tangent) linear system. The model object allows a rapid build of the model since most classical parts of a model are pre\sphinxhyphen{}programmed: standard boundary conditions, standard partial differential equations, use of multipliers to prescribe a constraint … Moreover, some bricks are designed to extend the possibilities of the standard bricks (generic assembly bricks, explicit matrix brick …). Thus, it is recommended to use the framework of the model object.

There are two versions of the model: the real one and the complex one. Complex models have to be reserved for special applications (some electromagnetism problems for instance) where it is advantageous to solve a complex linear system.

Let us declare a real model with the three variables corresponding to the three fields to be computed:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{model} \PYG{n}{md}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{u}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{theta}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{mft}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{V}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{mft}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{=}\PYG{n}{gf}\PYG{o}{.}\PYG{n}{Model}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{real}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{theta}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mft}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{V}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mft}\PYG{p}{)}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{p}{=}\PYG{n}{gf\PYGZus{}model}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{real\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add fem variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add fem variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{,} \PYG{n}{mft}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add fem variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{,} \PYG{n}{mft}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{p}{=}\PYG{n}{gf\PYGZus{}model}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{real\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add fem variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add fem variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{,} \PYG{n}{mft}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add fem variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{,} \PYG{n}{mft}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Membrane elastic deformation problem}
\label{\detokenize{tutorial/thermo_coupling:membrane-elastic-deformation-problem}}
Let us now begin by the elastic deformation problem. We will use the predefined brick added by \sphinxtitleref{add\_isotropic\_linearized\_elasticity\_brick} below. Basically it adds the term corresponding to
\begin{equation*}
\begin{split}\int_{\Omega} (\lambda^* \mbox{div}(u) I + 2\mu \bar{\varepsilon}(u)):\bar{\varepsilon}(\delta_u)dx,\end{split}
\end{equation*}
to the tangent linear system. In order to use this model brick, the data corresponding to the Lamé coefficient have to be added to the model first. Here, the Lamé coefficients are constant over the domain. However, it it also possible to define some non\sphinxhyphen{}constant data. Note also that instead of using this predefined brick, one can use equivalently GWFL, the generic weak form language term \sphinxtitleref{add\_linear\_term(md mim, “lambda*(Div\_u*Div\_Test\_u) + mu*((Grad\_u + Grad\_u’):Grad\_Test\_u)”}.

Concerning the coupling term
\begin{equation*}
\begin{split}\int_{\Omega} (\beta\theta I) :\bar{\varepsilon}(\delta_u)dx,\end{split}
\end{equation*}
there is no predefined brick and we use directly a GWFL term \sphinxtitleref{add\_linear\_term(md mim, “beta*theta*Div\_Test\_u)”}. See \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}gasm\sphinxhyphen{}high} for more details on GWFL. Basically, the principle is that the assembly string is compiled into a list of optimized assembly instructions which are executed on each Gauss point.

The following program allows to take into account the whole elastic deformation equation. Note the use of specific brick to prescribe the Dirichlet condition on the left boundary. There is several option to prescribe a Dirichlet condition (see \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}model\sphinxhyphen{}Dirichlet}).


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}scalar\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{cmu}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{cmu}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}scalar\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{clambdastar}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{clambdastar}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}scalar\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{T0}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{T0}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{add\PYGZus{}isotropic\PYGZus{}linearized\PYGZus{}elasticity\PYGZus{}brick}
  \PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{u}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{clambdastar}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{cmu}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{add\PYGZus{}Dirichlet\PYGZus{}condition\PYGZus{}with\PYGZus{}multipliers}
  \PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{u}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{bgeot}\PYG{o}{:}\PYG{o}{:}\PYG{n}{dim\PYGZus{}type}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}fixed\PYGZus{}size\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Fdata}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{base\PYGZus{}small\PYGZus{}vector}\PYG{p}{(}\PYG{n}{F}\PYG{o}{*}\PYG{n}{epsilon}\PYG{p}{,}\PYG{l+m+mf}{0.}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{add\PYGZus{}source\PYGZus{}term\PYGZus{}brick}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{u}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Fdata}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}scalar\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{beta}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{alpha\PYGZus{}th}\PYG{o}{*}\PYG{n}{E}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{nu}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{add\PYGZus{}linear\PYGZus{}term}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{beta*(T0\PYGZhy{}theta)*Div\PYGZus{}Test\PYGZus{}u}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cmu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{cmu}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clambdastar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{clambdastar}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{T0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}isotropic\PYGZus{}linearized\PYGZus{}elasticity\PYGZus{}brick}\PYG{p}{(}\PYG{n}{mim}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clambdastar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cmu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}Dirichlet\PYGZus{}condition\PYGZus{}with\PYGZus{}multipliers}\PYG{p}{(}\PYG{n}{mim}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Fdata}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{F}\PYG{o}{*}\PYG{n}{epsilon}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}source\PYGZus{}term\PYGZus{}brick}\PYG{p}{(}\PYG{n}{mim}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Fdata}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{)}

\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{beta}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{alpha\PYGZus{}th}\PYG{o}{*}\PYG{n}{E}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{nu}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}linear\PYGZus{}term}\PYG{p}{(}\PYG{n}{mim}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{beta*(T0\PYGZhy{}theta)*Div\PYGZus{}Test\PYGZus{}u}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{cmu\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{cmu}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{clambdastar\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{clambdastar}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{T0\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{T0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add isotropic linearized elasticity brick\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{clambdastar\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{cmu\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add Dirichlet condition with multipliers\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Fdata\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{F}\PYG{o}{*}\PYG{n}{epsilon}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add source term brick\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Fdata\PYGZsq{}}\PYG{p}{,} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{beta\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{alpha\PYGZus{}th}\PYG{o}{*}\PYG{n}{E}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{nu}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add linear term\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{beta*(T0\PYGZhy{}theta)*Div\PYGZus{}Test\PYGZus{}u\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{cmu\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{cmu}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{clambdastar\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{clambdastar}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{T0\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{T0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add isotropic linearized elasticity brick\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{clambdastar\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{cmu\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add Dirichlet condition with multipliers\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Fdata\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{F}\PYG{o}{*}\PYG{n}{epsilon}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add source term brick\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Fdata\PYGZsq{}}\PYG{p}{,} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{beta\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{alpha\PYGZus{}th}\PYG{o}{*}\PYG{n}{E}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{nu}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add linear term\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{beta*(T0\PYGZhy{}theta)*Div\PYGZus{}Test\PYGZus{}u\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

\clearpage


\subsection{Electric potential problem}
\label{\detokenize{tutorial/thermo_coupling:id1}}
Similarly, the following program take into account the electric potential equation. Note the definition of the  electrical conductivity \(\sigma\) and again the use of GWFL terms.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{std}\PYG{o}{:}\PYG{o}{:}\PYG{n}{string} \PYG{n}{sigmaeps} \PYG{o}{=} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{(eps/(rho\PYGZus{}0*(1+alpha*(theta\PYGZhy{}T0))))}\PYG{l+s}{\PYGZdq{}}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}scalar\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{eps}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{epsilon}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}scalar\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{rho\PYGZus{}0}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{rho\PYGZus{}0}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}scalar\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{alpha}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{alpha}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{add\PYGZus{}nonlinear\PYGZus{}term}
  \PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{n}{sigmaeps}\PYG{o}{+}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{*(Grad\PYGZus{}V.Grad\PYGZus{}Test\PYGZus{}V)}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{add\PYGZus{}Dirichlet\PYGZus{}condition\PYGZus{}with\PYGZus{}multipliers}
  \PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{V}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{bgeot}\PYG{o}{:}\PYG{o}{:}\PYG{n}{dim\PYGZus{}type}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}scalar\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{DdataV}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{add\PYGZus{}Dirichlet\PYGZus{}condition\PYGZus{}with\PYGZus{}multipliers}
  \PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{V}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{bgeot}\PYG{o}{:}\PYG{o}{:}\PYG{n}{dim\PYGZus{}type}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{DdataV}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{sigmaeps} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{(eps/(rho\PYGZus{}0*(1+alpha*(theta\PYGZhy{}T0))))}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{eps}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{epsilon}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rho\PYGZus{}0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{rho\PYGZus{}0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{alpha}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{alpha}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}nonlinear\PYGZus{}term}\PYG{p}{(}\PYG{n}{mim}\PYG{p}{,} \PYG{n}{sigmaeps}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*(Grad\PYGZus{}V.Grad\PYGZus{}Test\PYGZus{}V)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}Dirichlet\PYGZus{}condition\PYGZus{}with\PYGZus{}multipliers}\PYG{p}{(}\PYG{n}{mim}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{V}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DdataV}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}Dirichlet\PYGZus{}condition\PYGZus{}with\PYGZus{}multipliers}\PYG{p}{(}\PYG{n}{mim}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{V}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DdataV}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{sigmaps} \PYG{p}{=} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{(eps/(rho\PYGZus{}0*(1+alpha*(theta\PYGZhy{}T0))))\PYGZsq{}}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{eps\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{epsilon}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{rho\PYGZus{}0\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{rho\PYGZus{}0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{alpha\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{alpha}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add nonlinear term\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{n}{sigmaeps}\PYG{o}{+}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*(Grad\PYGZus{}V.Grad\PYGZus{}Test\PYGZus{}V)\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add Dirichlet condition with multipliers\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{DdataV\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add Dirichlet condition with multipliers\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{DdataV\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{sigmaps} \PYG{p}{=} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{(eps/(rho\PYGZus{}0*(1+alpha*(theta\PYGZhy{}T0))))\PYGZsq{}}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{eps\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{epsilon}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{rho\PYGZus{}0\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{rho\PYGZus{}0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{alpha\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{alpha}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add nonlinear term\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{p}{[}\PYG{n}{sigmaeps} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*(Grad\PYGZus{}V.Grad\PYGZus{}Test\PYGZus{}V)\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add Dirichlet condition with multipliers\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{RIGHT\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{DdataV\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add Dirichlet condition with multipliers\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{LEFT\PYGZus{}BOUND}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{DdataV\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Thermal problem}
\label{\detokenize{tutorial/thermo_coupling:id2}}
Now, the program to take into account the thermal problem:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}scalar\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{kaeps}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{kappa}\PYG{o}{*}\PYG{n}{epsilon}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{add\PYGZus{}generic\PYGZus{}elliptic\PYGZus{}brick}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{theta}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{kaeps}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}scalar\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{D2}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{D}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}scalar\PYGZus{}data}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{D2airt}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{air\PYGZus{}temp}\PYG{o}{*}\PYG{n}{D}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{add\PYGZus{}mass\PYGZus{}brick}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{theta}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{D2}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{add\PYGZus{}source\PYGZus{}term\PYGZus{}brick}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{theta}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{D2airt}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{add\PYGZus{}nonlinear\PYGZus{}term}
  \PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZhy{}}\PYG{l+s}{\PYGZdq{}}\PYG{o}{+}\PYG{n}{sigmaeps}\PYG{o}{+}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{*Norm\PYGZus{}sqr(Grad\PYGZus{}V)*Test\PYGZus{}theta}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{kaeps}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{kappa}\PYG{o}{*}\PYG{n}{epsilon}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}generic\PYGZus{}elliptic\PYGZus{}brick}\PYG{p}{(}\PYG{n}{mim}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{theta}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{kaeps}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{D}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D2airt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{air\PYGZus{}temp}\PYG{o}{*}\PYG{n}{D}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}mass\PYGZus{}brick}\PYG{p}{(}\PYG{n}{mim}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{theta}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}source\PYGZus{}term\PYGZus{}brick}\PYG{p}{(}\PYG{n}{mim}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{theta}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D2airt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}nonlinear\PYGZus{}term}\PYG{p}{(}\PYG{n}{mim}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{sigmaeps}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*Norm\PYGZus{}sqr(Grad\PYGZus{}V)*Test\PYGZus{}theta}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{kaeps\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{kappa}\PYG{o}{*}\PYG{n}{epsilon}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add generic elliptic brick\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{kaeps\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{D2\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{D}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{D2airt\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{air\PYGZus{}temp}\PYG{o}{*}\PYG{n}{D}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add mass brick\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{D2\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add source term brick\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{D2airt\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add nonlinear term\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZsq{}}\PYG{o}{+}\PYG{n}{sigmaeps}\PYG{o}{+}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*Norm\PYGZus{}sqr(Grad\PYGZus{}V)*Test\PYGZus{}theta\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{kaeps\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{kappa}\PYG{o}{*}\PYG{n}{epsilon}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add generic elliptic brick\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{kaeps\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{D2\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{D}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add initialized data\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{D2airt\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{air\PYGZus{}temp}\PYG{o}{*}\PYG{n}{D}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add mass brick\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{D2\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add source term brick\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{D2airt\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{add nonlinear term\PYGZsq{}}\PYG{p}{,} \PYG{n}{mim}\PYG{p}{,} \PYG{p}{[}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZsq{}} \PYG{n}{sigmaeps} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*Norm\PYGZus{}sqr(Grad\PYGZus{}V)*Test\PYGZus{}theta\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Model solve}
\label{\detokenize{tutorial/thermo_coupling:model-solve}}
Once the model is correctly defined, we can simply solve it by:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gmm}\PYG{o}{:}\PYG{o}{:}\PYG{n}{iteration} \PYG{n}{iter}\PYG{p}{(}\PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{standard\PYGZus{}solve}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{iter}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{solve}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}res}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{noisy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{solve\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}res\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}iter\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{noisy\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{solve\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}res\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}iter\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{noisy\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

Since the problem is globally nonlinear, a Newton method is used to iteratively solve the problem. It needs a few iterations (about 4 in that case).


\subsection{Model solve with two steps}
\label{\detokenize{tutorial/thermo_coupling:model-solve-with-two-steps}}
Another option to solve the problem is to solve first the thermal and electric potential problems. Indeed, in our model, the thermal and  electric potential do not depend on the deformation. Once the  thermal and electric potential problem, we then solve the deformation problem. This can be done as follows:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gmm}\PYG{o}{:}\PYG{o}{:}\PYG{n}{iteration} \PYG{n}{iter}\PYG{p}{(}\PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{disable\PYGZus{}variable}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{u}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{standard\PYGZus{}solve}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{iter}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{enable\PYGZus{}variable}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{u}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{disable\PYGZus{}variable}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{theta}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{p}{.}\PYG{n}{disable\PYGZus{}variable}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{V}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{iter}\PYG{p}{.}\PYG{n}{init}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{standard\PYGZus{}solve}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{n}{iter}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{disable\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{solve}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}res}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{noisy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{enable\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{disable\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{theta}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{disable\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{V}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{solve}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}res}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{noisy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{disable variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{solve\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}res\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}iter\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{noisy\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{enable variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{disable variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{disable variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{solve\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}res\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}iter\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{noisy\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{disable variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{solve\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}res\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}iter\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{noisy\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{enable variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{disable variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}set}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{disable variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{solve\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}res\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{max\PYGZus{}iter\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{noisy\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Export/visualization of the solution}
\label{\detokenize{tutorial/thermo_coupling:export-visualization-of-the-solution}}
The finite element problem is now solved. We can plot the solution as follows. Note that for the C++ and Python programs, it is necessary to use an external graphical post\sphinxhyphen{}processor. Note also that arbitrary quantities can be post\sphinxhyphen{}processed using the generic interpolation (see \sphinxtitleref{ga\_interpolation\_Lagrange\_fem} below). It is also possible to make complex exports and slices (see \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}export}).


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{C++}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{plain\PYGZus{}vector} \PYG{n+nf}{U}\PYG{p}{(}\PYG{n}{mfu}\PYG{p}{.}\PYG{n}{nb\PYGZus{}dof}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;} \PYG{n}{gmm}\PYG{o}{:}\PYG{o}{:}\PYG{n}{copy}\PYG{p}{(}\PYG{n}{md}\PYG{p}{.}\PYG{n}{real\PYGZus{}variable}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{u}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,} \PYG{n}{U}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{plain\PYGZus{}vector} \PYG{n+nf}{V}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{.}\PYG{n}{nb\PYGZus{}dof}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;} \PYG{n}{gmm}\PYG{o}{:}\PYG{o}{:}\PYG{n}{copy}\PYG{p}{(}\PYG{n}{md}\PYG{p}{.}\PYG{n}{real\PYGZus{}variable}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{V}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,} \PYG{n}{V}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{plain\PYGZus{}vector} \PYG{n+nf}{THETA}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{.}\PYG{n}{nb\PYGZus{}dof}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;} \PYG{n}{gmm}\PYG{o}{:}\PYG{o}{:}\PYG{n}{copy}\PYG{p}{(}\PYG{n}{md}\PYG{p}{.}\PYG{n}{real\PYGZus{}variable}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{theta}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{n}{THETA}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{plain\PYGZus{}vector} \PYG{n+nf}{VM}\PYG{p}{(}\PYG{n}{mfvm}\PYG{p}{.}\PYG{n}{nb\PYGZus{}dof}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{compute\PYGZus{}isotropic\PYGZus{}linearized\PYGZus{}Von\PYGZus{}Mises\PYGZus{}or\PYGZus{}Tresca}
  \PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{u}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{clambdastar}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{cmu}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{mfvm}\PYG{p}{,} \PYG{n}{VM}\PYG{p}{,} \PYG{n+nb}{false}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{plain\PYGZus{}vector} \PYG{n+nf}{CO}\PYG{p}{(}\PYG{n}{mfvm}\PYG{p}{.}\PYG{n}{nb\PYGZus{}dof}\PYG{p}{(}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{ga\PYGZus{}interpolation\PYGZus{}Lagrange\PYGZus{}fem}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZhy{}}\PYG{l+s}{\PYGZdq{}}\PYG{o}{+}\PYG{n}{sigmaeps}\PYG{o}{+}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{*Grad\PYGZus{}V}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}  \PYG{n}{mfvm}\PYG{p}{,} \PYG{n}{CO}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{vtk\PYGZus{}export} \PYG{n}{exp}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{displacement\PYGZus{}with\PYGZus{}von\PYGZus{}mises.vtk}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n+nb}{false}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{exp}\PYG{p}{.}\PYG{n}{exporting}\PYG{p}{(}\PYG{n}{mfu}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{exp}\PYG{p}{.}\PYG{n}{write\PYGZus{}point\PYGZus{}data}\PYG{p}{(}\PYG{n}{mfu}\PYG{p}{,} \PYG{n}{U}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{elastostatic displacement}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{exp}\PYG{p}{.}\PYG{n}{write\PYGZus{}point\PYGZus{}data}\PYG{p}{(}\PYG{n}{mfvm}\PYG{p}{,} \PYG{n}{VM}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Von Mises stress}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{cout} \PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZlt{}} \PYG{l+s}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{You can view solutions with for instance:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{mayavi2 }\PYG{l+s}{\PYGZdq{}}
  \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZhy{}d displacement\PYGZus{}with\PYGZus{}von\PYGZus{}mises.vtk \PYGZhy{}f WarpVector \PYGZhy{}m Surface}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}} \PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZlt{}} \PYG{n}{endl}\PYG{p}{;}

\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{vtk\PYGZus{}export} \PYG{n}{exp2}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{temperature.vtk}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n+nb}{false}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{exp2}\PYG{p}{.}\PYG{n}{exporting}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{exp2}\PYG{p}{.}\PYG{n}{write\PYGZus{}point\PYGZus{}data}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{,} \PYG{n}{THETA}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Temperature}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{cout} \PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZlt{}} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{mayavi2 \PYGZhy{}d temperature.vtk \PYGZhy{}f WarpScalar \PYGZhy{}m Surface}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}} \PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZlt{}} \PYG{n}{endl}\PYG{p}{;}

\PYG{n}{getfem}\PYG{o}{:}\PYG{o}{:}\PYG{n}{vtk\PYGZus{}export} \PYG{n}{exp3}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{electric\PYGZus{}potential.vtk}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n+nb}{false}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{exp3}\PYG{p}{.}\PYG{n}{exporting}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{exp3}\PYG{p}{.}\PYG{n}{write\PYGZus{}point\PYGZus{}data}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{,} \PYG{n}{V}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Electric potential}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{cout} \PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZlt{}} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{mayavi2 \PYGZhy{}d electric\PYGZus{}potential.vtk \PYGZhy{}f WarpScalar \PYGZhy{}m Surface}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}
     \PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZlt{}} \PYG{n}{endl}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatimintable}
\\
\hline
\sphinxstylestrong{Python}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{U} \PYG{o}{=} \PYG{n}{md}\PYG{o}{.}\PYG{n}{variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{V} \PYG{o}{=} \PYG{n}{md}\PYG{o}{.}\PYG{n}{variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{V}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{THETA} \PYG{o}{=} \PYG{n}{md}\PYG{o}{.}\PYG{n}{variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{theta}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{VM} \PYG{o}{=} \PYG{n}{md}\PYG{o}{.}\PYG{n}{compute\PYGZus{}isotropic\PYGZus{}linearized\PYGZus{}Von\PYGZus{}Mises\PYGZus{}or\PYGZus{}Tresca}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clambdastar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cmu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfvm}\PYG{p}{)}
\PYG{n}{CO} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{n}{md}\PYG{o}{.}\PYG{n}{interpolation}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{sigmaeps}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*Grad\PYGZus{}V}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfvm}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{mfvm}\PYG{o}{.}\PYG{n}{nbdof}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{F}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{mfvm}\PYG{o}{.}\PYG{n}{export\PYGZus{}to\PYGZus{}vtk}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{displacement\PYGZus{}with\PYGZus{}von\PYGZus{}mises.vtk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfvm}\PYG{p}{,}
                   \PYG{n}{VM}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Von Mises Stresses}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{,} \PYG{n}{U}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Displacements}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{You can view solutions with for instance:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mayavi2 \PYGZhy{}d displacement\PYGZus{}with\PYGZus{}von\PYGZus{}mises.vtk \PYGZhy{}f WarpVector \PYGZhy{}m Surface}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{mft}\PYG{o}{.}\PYG{n}{export\PYGZus{}to\PYGZus{}vtk}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{temperature.vtk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mft}\PYG{p}{,} \PYG{n}{THETA}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mayavi2 \PYGZhy{}d temperature.vtk \PYGZhy{}f WarpScalar \PYGZhy{}m Surface}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{mft}\PYG{o}{.}\PYG{n}{export\PYGZus{}to\PYGZus{}vtk}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{electric\PYGZus{}potential.vtk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mft}\PYG{p}{,} \PYG{n}{V}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Electric potential}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mayavi2 \PYGZhy{}d electric\PYGZus{}potential.vtk \PYGZhy{}f WarpScalar \PYGZhy{}m Surface}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{Scilab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{U} \PYG{p}{=} \PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{V} \PYG{p}{=} \PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{THETA} \PYG{p}{=} \PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{VM} \PYG{p}{=} \PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{compute\PYGZus{}isotropic\PYGZus{}linearized\PYGZus{}Von\PYGZus{}Mises\PYGZus{}or\PYGZus{}Tresca\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{clambdastar\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{cmu\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfvm}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{CO} \PYG{p}{=} \PYG{n}{matrix}\PYG{p}{(}\PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{interpolation\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZsq{}}\PYG{o}{+}\PYG{n}{sigmaeps}\PYG{o}{+}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*Grad\PYGZus{}V\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfvm}\PYG{p}{)}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem\PYGZus{}get}\PYG{p}{(}\PYG{n}{mfvm}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{nbdof\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{hh} \PYG{p}{=} \PYG{n}{scf}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hh}\PYG{p}{.}\PYG{n}{color\PYGZus{}map} \PYG{p}{=} \PYG{n}{jetcolormap}\PYG{p}{(}\PYG{l+m+mi}{255}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}plot}\PYG{p}{(}\PYG{n}{mfvm}\PYG{p}{,} \PYG{n}{VM}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{mesh\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformed\PYGZus{}mesh\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZsq{}}\PYG{p}{,} \PYG{n}{U}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}mf\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}scale\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{refine\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{colorbar}\PYG{p}{(}\PYG{n}{min}\PYG{p}{(}\PYG{n}{VM}\PYG{p}{)}\PYG{p}{,}\PYG{n}{max}\PYG{p}{(}\PYG{n}{VM}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Von Mises stress in N/cm\PYGZca{}2 (on the deformed configuration, scale factor x100)\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{drawlater}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}plot}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{,} \PYG{n}{V}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{mesh\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformed\PYGZus{}mesh\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZsq{}}\PYG{p}{,} \PYG{n}{U}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}mf\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}scale\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{refine\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{colorbar}\PYG{p}{(}\PYG{n}{min}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{p}{,}\PYG{n}{max}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}plot}\PYG{p}{(}\PYG{n}{mfvm}\PYG{p}{,} \PYG{n}{CO}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{quiver\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{on\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{quiver\PYGZus{}density\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{mesh\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformed\PYGZus{}mesh\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}mf\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{,} \PYG{c}{...}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZsq{}}\PYG{p}{,} \PYG{n}{U}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}scale\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{refine\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Electric potential in Volt (on the deformed configuration, scale factor x100)\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{drawnow}\PYG{p}{;}
\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}plot}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{,} \PYG{n}{THETA}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{mesh\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformed\PYGZus{}mesh\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZsq{}}\PYG{p}{,} \PYG{n}{U}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}mf\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}scale\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{refine\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{colorbar}\PYG{p}{(}\PYG{n}{min}\PYG{p}{(}\PYG{n}{THETA}\PYG{p}{)}\PYG{p}{,}\PYG{n}{max}\PYG{p}{(}\PYG{n}{THETA}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Temperature in °C (on the deformed configuration, scale factor x100)\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|p{0.080\linewidth}|p{0.900\linewidth}|}
\hline

\sphinxstylestrong{Matlab}
&
\begin{sphinxVerbatimintable}[commandchars=\\\{\}]
\PYG{n}{U} \PYG{p}{=} \PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{V} \PYG{p}{=} \PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{THETA} \PYG{p}{=} \PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{variable\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{theta\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{VM} \PYG{p}{=} \PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{compute\PYGZus{}isotropic\PYGZus{}linearized\PYGZus{}Von\PYGZus{}Mises\PYGZus{}or\PYGZus{}Tresca\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{u\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{clambdastar\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{cmu\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfvm}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{CO} \PYG{p}{=} \PYG{n+nb}{reshape}\PYG{p}{(}\PYG{n}{gf\PYGZus{}model\PYGZus{}get}\PYG{p}{(}\PYG{n}{md}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{interpolation\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZsq{}} \PYG{n}{sigmaeps} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*Grad\PYGZus{}V\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{mfvm}\PYG{p}{)}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2} \PYG{n}{gf\PYGZus{}mesh\PYGZus{}fem\PYGZus{}get}\PYG{p}{(}\PYG{n}{mfvm}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{nbdof\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{figure}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}plot}\PYG{p}{(}\PYG{n}{mfvm}\PYG{p}{,} \PYG{n}{VM}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{mesh\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformed\PYGZus{}mesh\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZsq{}}\PYG{p}{,} \PYG{n}{U}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}mf\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}scale\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{refine\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{colorbar}\PYG{p}{;}
\PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Von Mises stress in N/cm\PYGZca{}2 (on the deformed configuration, scale factor x100)\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hold} \PYG{l+s}{on}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}plot}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{,} \PYG{n}{V}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{mesh\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformed\PYGZus{}mesh\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZsq{}}\PYG{p}{,} \PYG{n}{U}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}mf\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}scale\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{refine\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{colorbar}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}plot}\PYG{p}{(}\PYG{n}{mfvm}\PYG{p}{,} \PYG{n}{CO}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{quiver\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{on\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{quiver\PYGZus{}density\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{mesh\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformed\PYGZus{}mesh\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZsq{}}\PYG{p}{,} \PYG{n}{U}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}mf\PYGZsq{}}\PYG{p}{,} \PYG{c}{...}
        \PYG{n}{mfu}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}scale\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{refine\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{colorbar}\PYG{p}{;}
\PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Electric potential in Volt (on the deformed configuration, scale factor x100)\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hold} \PYG{l+s}{off}\PYG{p}{;}
\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{gf\PYGZus{}plot}\PYG{p}{(}\PYG{n}{mft}\PYG{p}{,} \PYG{n}{THETA}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{mesh\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformed\PYGZus{}mesh\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{off\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZsq{}}\PYG{p}{,} \PYG{n}{U}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}mf\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{deformation\PYGZus{}scale\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{refine\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{colorbar}\PYG{p}{;}
\PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Temperature in ?C (on the deformed configuration, scale factor x100)\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatimintable}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[scale=1.0]{{solution_thermo}.png}
\caption{Plot of the solution.}\label{\detokenize{tutorial/thermo_coupling:id4}}\label{\detokenize{tutorial/thermo_coupling:tut-fig-solthermo}}\end{figure}


\chapter{Example of wheel in contact (Assembly between two meshes, transformations, use of fixed size variables)}
\label{\detokenize{tutorial/wheel:example-of-wheel-in-contact-assembly-between-two-meshes-transformations-use-of-fixed-size-variables}}\label{\detokenize{tutorial/wheel:tut-wheel}}\label{\detokenize{tutorial/wheel::doc}}
In this example of a deformable ‘’wheel’’ enters in contact with a deformable foundation. We use here python interface, translate this program for another interface or in C++ is easy (see the previous example). The complete program  \sphinxtitleref{demo\_wheel\_contact.py} can be found in the directory \sphinxtitleref{interface/tests/python}.


\section{The problem setting}
\label{\detokenize{tutorial/wheel:the-problem-setting}}
Let \(\Omega^1 \subset \rm I\hspace{-0.15em}R^2\) be the reference configuration of a 2D wheel and \(\Omega^2 \subset \rm I\hspace{-0.15em}R^2\) the reference configuration of a deformable foundation. We consider small deformation of these two bodies (linearized elasticity) and the contact between them. We also consider that the rim of the wheel is rigid and apply a vertical force on the wheel.


\section{Building the program}
\label{\detokenize{tutorial/wheel:building-the-program}}
Let us begin by loading Getfem and fixing the parameters of the problem

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{getfem} \PYG{k}{as} \PYG{n+nn}{gf}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}

\PYG{n}{E} \PYG{o}{=} \PYG{l+m+mf}{21E6}                         \PYG{c+c1}{\PYGZsh{} Young Modulus (N/cm\PYGZca{}2)}
\PYG{n}{nu} \PYG{o}{=} \PYG{l+m+mf}{0.3}                         \PYG{c+c1}{\PYGZsh{} Poisson ratio}
\PYG{n}{clambda} \PYG{o}{=} \PYG{n}{E}\PYG{o}{*}\PYG{n}{nu}\PYG{o}{/}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{nu}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{nu}\PYG{p}{)}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} First Lame coefficient (N/cm\PYGZca{}2)}
\PYG{n}{cmu} \PYG{o}{=} \PYG{n}{E}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{nu}\PYG{p}{)}\PYG{p}{)}               \PYG{c+c1}{\PYGZsh{} Second Lame coefficient (N/cm\PYGZca{}2)}
\PYG{n}{clambdastar} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{clambda}\PYG{o}{*}\PYG{n}{cmu}\PYG{o}{/}\PYG{p}{(}\PYG{n}{clambda}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{cmu}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} Lame coefficient for Plane stress (N/cm\PYGZca{}2)}
\PYG{n}{applied\PYGZus{}force} \PYG{o}{=} \PYG{l+m+mf}{1E7}              \PYG{c+c1}{\PYGZsh{} Force at the hole boundary (N)}

\PYG{n}{h} \PYG{o}{=} \PYG{l+m+mi}{1}                      \PYG{c+c1}{\PYGZsh{} Approximate mesh size}
\PYG{n}{elements\PYGZus{}degree} \PYG{o}{=} \PYG{l+m+mi}{2}        \PYG{c+c1}{\PYGZsh{} Degree of the finite element methods}
\PYG{n}{gamma0} \PYG{o}{=} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{n}{E}\PYG{p}{;}             \PYG{c+c1}{\PYGZsh{} Augmentation parameter for the augmented Lagrangian}
\end{sphinxVerbatim}


\subsection{Mesh generation}
\label{\detokenize{tutorial/wheel:mesh-generation}}
We consider that the radius of the wheel is 15cm and the one of the rim 8cm and that the wheel lies on a deformable foundation of thickness 10cm. We generate the mesh of the wheel using the experimental mesher of \sphinxstyleemphasis{GetFEM}. Concerning the mesh of the foundation, we build a structured mesh (see the documentation of the Mesh object in the python interface).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mo1} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MesherObject}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ball}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{l+m+mf}{15.}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{15.}\PYG{p}{)}
\PYG{n}{mo2} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MesherObject}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ball}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{l+m+mf}{15.}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{8.}\PYG{p}{)}
\PYG{n}{mo3} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MesherObject}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{set minus}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mo1}\PYG{p}{,} \PYG{n}{mo2}\PYG{p}{)}
\PYG{n}{gf}\PYG{o}{.}\PYG{n}{util}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trace level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}   \PYG{c+c1}{\PYGZsh{} No trace for mesh generation}
\PYG{n}{mesh1} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{Mesh}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{generate}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mo3}\PYG{p}{,} \PYG{n}{h}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}

\PYG{n}{mesh2} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{Mesh}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{import}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{structured}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GT=}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{GT\PYGZus{}PK(2,1)}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{;SIZES=[30,10];NOISED=0;NSUBDIV=[}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{,}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{];}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n+nb}{int}\PYG{p}{(}\PYG{l+m+mi}{30}\PYG{o}{/}\PYG{n}{h}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n+nb}{int}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{o}{/}\PYG{n}{h}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{mesh2}\PYG{o}{.}\PYG{n}{translate}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{15.}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{10.}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

The result is the following

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[scale=1.0]{{wheel_mesh}.png}
\end{figure}


\subsection{Boundary selection}
\label{\detokenize{tutorial/wheel:boundary-selection}}
We have to select the different parts of the boundary where we will set some boundary conditions, namely the boundary of the rim (in order to apply a force and the fact that the rim is rigid), the contact boundary of the wheel and the bottom boundary of the foundation that we will assume clamped.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fb1} \PYG{o}{=} \PYG{n}{mesh1}\PYG{o}{.}\PYG{n}{outer\PYGZus{}faces\PYGZus{}in\PYGZus{}box}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{8.1}\PYG{p}{,} \PYG{l+m+mf}{6.9}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{8.1}\PYG{p}{,} \PYG{l+m+mf}{23.1}\PYG{p}{]}\PYG{p}{)}     \PYG{c+c1}{\PYGZsh{} Boundary of the hole}
\PYG{n}{fb2} \PYG{o}{=} \PYG{n}{mesh1}\PYG{o}{.}\PYG{n}{outer\PYGZus{}faces\PYGZus{}with\PYGZus{}direction}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.}\PYG{p}{]}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mf}{4.5}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} Contact boundary of the wheel}
\PYG{n}{fb3} \PYG{o}{=} \PYG{n}{mesh2}\PYG{o}{.}\PYG{n}{outer\PYGZus{}faces\PYGZus{}with\PYGZus{}direction}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{)}      \PYG{c+c1}{\PYGZsh{} Bottom boundary of the foundation}

\PYG{n}{HOLE\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{CONTACT\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{;} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{;}

\PYG{n}{mesh1}\PYG{o}{.}\PYG{n}{set\PYGZus{}region}\PYG{p}{(}\PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb1}\PYG{p}{)}
\PYG{n}{mesh1}\PYG{o}{.}\PYG{n}{set\PYGZus{}region}\PYG{p}{(}\PYG{n}{CONTACT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb2}\PYG{p}{)}
\PYG{n}{mesh1}\PYG{o}{.}\PYG{n}{region\PYGZus{}subtract}\PYG{p}{(}\PYG{n}{CONTACT\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}
\PYG{n}{mesh2}\PYG{o}{.}\PYG{n}{set\PYGZus{}region}\PYG{p}{(}\PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{,} \PYG{n}{fb3}\PYG{p}{)}
\end{sphinxVerbatim}

Note that the command \sphinxtitleref{mesh1.outer\_faces\_with\_direction({[}0., \sphinxhyphen{}1.{]}, np.pi/4)} allows to select all the faces having a unit outward normal having an angle less or equal to \sphinxtitleref{np.pi/4} with the vector \sphinxtitleref{{[}0., \sphinxhyphen{}1.{]}}. The command \sphinxtitleref{mesh1.region\_subtract(CONTACT\_BOUND, HOLE\_BOUND)} allow to delete the faces corresponding to the rim in the contact boundary.


\subsection{Definition of finite elements methods and integration method}
\label{\detokenize{tutorial/wheel:definition-of-finite-elements-methods-and-integration-method}}
We define \sphinxtitleref{mfu1}, \sphinxtitleref{mfu2} two finite element methods which will approximate the displacements in the wheel and the foundation respectively. \sphinxtitleref{mflambda} is  finite element method to approximate a multiplier to take into account the rigidity of the rim, \sphinxtitleref{mflambda\_C} is to approximate the contact multiplier (contact pressure) and \sphinxtitleref{mfvm1}, \sphinxtitleref{mfvm2} will be used to interpolate the Von Mises stresses of the wheel and the foundation for post\sphinxhyphen{}processing. \sphinxtitleref{mim1}, \sphinxtitleref{mim2} are two integration methods on the  wheel and the foundation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mfu1} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshFem}\PYG{p}{(}\PYG{n}{mesh1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{mfu1}\PYG{o}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}fem}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}
\PYG{n}{mflambda} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshFem}\PYG{p}{(}\PYG{n}{mesh1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{mflambda}\PYG{o}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}fem}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{mflambda\PYGZus{}C} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshFem}\PYG{p}{(}\PYG{n}{mesh1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{mflambda\PYGZus{}C}\PYG{o}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}fem}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{mfu2} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshFem}\PYG{p}{(}\PYG{n}{mesh2}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{mfu2}\PYG{o}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}fem}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}
\PYG{n}{mfvm1} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshFem}\PYG{p}{(}\PYG{n}{mesh1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{mfvm1}\PYG{o}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}discontinuous\PYGZus{}fem}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}
\PYG{n}{mfvm2} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshFem}\PYG{p}{(}\PYG{n}{mesh2}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{mfvm2}\PYG{o}{.}\PYG{n}{set\PYGZus{}classical\PYGZus{}discontinuous\PYGZus{}fem}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{)}
\PYG{n}{mim1} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshIm}\PYG{p}{(}\PYG{n}{mesh1}\PYG{p}{,} \PYG{n+nb}{pow}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{mim2} \PYG{o}{=} \PYG{n}{gf}\PYG{o}{.}\PYG{n}{MeshIm}\PYG{p}{(}\PYG{n}{mesh2}\PYG{p}{,} \PYG{n+nb}{pow}\PYG{p}{(}\PYG{n}{elements\PYGZus{}degree}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Model definition}
\label{\detokenize{tutorial/wheel:model-definition}}
We use a real model and declare the two variables which will represent the displacements:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{=}\PYG{n}{gf}\PYG{o}{.}\PYG{n}{Model}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{real}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu1}\PYG{p}{)}       \PYG{c+c1}{\PYGZsh{} Displacement of the structure 1}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfu2}\PYG{p}{)}       \PYG{c+c1}{\PYGZsh{} Displacement of the structure 2}
\end{sphinxVerbatim}


\subsection{Linearized elasticity bricks}
\label{\detokenize{tutorial/wheel:linearized-elasticity-bricks}}
We add the Lamé coefficients as data of the model and add a linearized elasticity brick for the wheel and the foundation:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cmu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{cmu}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clambdastar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{clambdastar}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}isotropic\PYGZus{}linearized\PYGZus{}elasticity\PYGZus{}brick}\PYG{p}{(}\PYG{n}{mim1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clambdastar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cmu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}isotropic\PYGZus{}linearized\PYGZus{}elasticity\PYGZus{}brick}\PYG{p}{(}\PYG{n}{mim2}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clambdastar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cmu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Clamped condition at the bottom of the foundation}
\label{\detokenize{tutorial/wheel:clamped-condition-at-the-bottom-of-the-foundation}}
We prescribed the displacement at  bottom face of the foundation to vanish, for instance with a multiplier with the add of the following brick:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}Dirichlet\PYGZus{}condition\PYGZus{}with\PYGZus{}multipliers}\PYG{p}{(}\PYG{n}{mim2}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{elements\PYGZus{}degree}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{BOTTOM\PYGZus{}BOUND}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Contact condition (use of interpolate transformations)}
\label{\detokenize{tutorial/wheel:contact-condition-use-of-interpolate-transformations}}
Now, let us see how to prescribed the contact condition between the two structures. It is possible to use predefined bricks (see  \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}model\sphinxhyphen{}contact\sphinxhyphen{}friction} for small deformation/small sliding contact and \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}model\sphinxhyphen{}contact\sphinxhyphen{}friction\sphinxhyphen{}large} for large deformation/large sliding contact). However, we will see here how to directly prescribe a contact condition using an augmented Lagrangian formulation and the interpolate transformations.

For small deformation contact, the correspondence between points of one contact surface to the other have to be described on the reference configuration and is not evolving, which is of course simpler but is an approximation.

We consider that the contact boundary of the wheel is the slave one and we have to describe the transformation from the contact boundary of the wheel to the contact boundary of the foundation. This is quite simple here, since the contact boundary of the foundation corresponds to a vanishing vertical coordinate. So we define the transformation
\begin{equation*}
\begin{split}X \longmapsto (X(1), 0)\end{split}
\end{equation*}
where \(X\) is the vector of coordinates of the point. We add this transformation to the model with the command

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}interpolate\PYGZus{}transformation\PYGZus{}from\PYGZus{}expression}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Proj1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mesh1}\PYG{p}{,} \PYG{n}{mesh2}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{[X(1);0]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

As a consequence, it will be possible to use this transformation, from the mesh of the wheel to the mesh of the foundation, into GWFL expressions. Notes that this is here a very simple constant expression. More complex expressions depending on the data or even the variables of the model can be used. If the expression of a transformation depends on the variable of the model, the tangent linear system will automatically takes into account this dependence (see \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}gasm\sphinxhyphen{}high\sphinxhyphen{}transf} for more details). Note also that transformation corresponding to a large sliding contact and automatically searching for the correspondence between contact boundaries exist in \sphinxstyleemphasis{GetFEM} (see \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}model\sphinxhyphen{}contact\sphinxhyphen{}friction\sphinxhyphen{}large\sphinxhyphen{}hlgav}).

Using the defined transformation, we can write an integral contact condition using an augmented Lagrangian formulation (see \DUrole{xref,std,std-ref}{ud\sphinxhyphen{}model\sphinxhyphen{}contact\sphinxhyphen{}friction} for more details). The corresponding term (to be added to the rest of the weak formulation) reads:
\begin{equation*}
\begin{split}& \cdots +  \int_{\Gamma_c} \lambda_N(X) (\delta_{u^1}(X)-\delta_{u^2}(\Pi(X)))\cdot n d\Gamma \\
& -   \int_{\Gamma_c} \left(\lambda_N(X) + \left(\lambda_N(X) + \dfrac{1}{h_T\gamma_0}((X + u^1(X))\cdot n - (\Pi(X) - u^2(\Pi(X)))\cdot n\right)_-\right)\delta_{\lambda_N}(X) d\Gamma = 0 ~~~~ \forall \delta_{\lambda_N}, \forall \delta_{u^1}, \forall \delta_{u^2},\end{split}
\end{equation*}
where \(\Gamma_c\) is the slave contact boundary, \(\lambda_N\) is the contact multiplier (contact pressure), \(h_T\) is the radius of the element, \(\Pi\) is the transformation, \sphinxtitleref{n} is the outward normal vector to the master contact boundary (here \(n = (0,1)\)), \(\gamma_0\) is an augmentation parameter, \((\cdot)_-:I\hspace{-0.2em}R\rightarrow I\hspace{-0.2em}R_+\) is the negative part and \(\delta_{\lambda_N}, \delta_{u^1}, \delta_{u^2}\) are the test  functions corresponding to \(\lambda_N, u^1, u^2\), respectively.

Using GWFL, the contact condition can be added by:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{gamma0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{gamma0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}filtered\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lambda1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mflambda\PYGZus{}C}\PYG{p}{,} \PYG{n}{CONTACT\PYGZus{}BOUND}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}nonlinear\PYGZus{}term}\PYG{p}{(}\PYG{n}{mim1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lambda1*(Test\PYGZus{}u1.[0;1])}\PYG{l+s+s1}{\PYGZsq{}}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}lambda1*(Interpolate(Test\PYGZus{}u2,Proj1).[0;1])}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{CONTACT\PYGZus{}BOUND}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}nonlinear\PYGZus{}term}\PYG{p}{(}\PYG{n}{mim1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}(gamma0*element\PYGZus{}size)}\PYG{l+s+s1}{\PYGZsq{}}
          \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*(lambda1 + neg\PYGZus{}part(lambda1+(1/(gamma0*element\PYGZus{}size))}\PYG{l+s+s1}{\PYGZsq{}}
          \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*((u1\PYGZhy{}Interpolate(u2,Proj1)+X\PYGZhy{}Interpolate(X,Proj1)).[0;1])))*Test\PYGZus{}lambda1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{CONTACT\PYGZus{}BOUND}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\subsection{Prescribing the rigidity of the rim and the vertical force}
\label{\detokenize{tutorial/wheel:prescribing-the-rigidity-of-the-rim-and-the-vertical-force}}
We have now to prescribe the rigidity of the rim. This is a non\sphinxhyphen{}standard condition, since we do not know a priori what will be the vertical displacement of the rim. We can use an additional unknown for that vertical displacement. We add an additional fixed size variable \sphinxtitleref{alpha\_D} (which mean that it does not a finite element field) of size 1 with

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{alpha\PYGZus{}D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

We need a multiplier to prescribe the displacement on the rim boundary:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}filtered\PYGZus{}fem\PYGZus{}variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lambda\PYGZus{}D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mflambda}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}
\end{sphinxVerbatim}

This multiplier represents the boundary stress that is necessary to prescribe the vertical displacement to be \((0, -\alpha_D)\). The constraint we want to apply on this multiplier is that its integral over the rim boundary is the vertical force we want to apply. The corresponding weak formulation term to be added to the rest of the weak formulation reads
\begin{equation*}
\begin{split}\cdots + \int_{\Gamma_D} -\lambda_D.\delta_{u^1} + ((0, \alpha_D) - u^1).\delta_{\lambda_D} + (\lambda_D.(0,1) + F)\delta_{\alpha_D} d\Gamma = 0,\end{split}
\end{equation*}
where \(\Gamma_D\) is the rim boundary, \(F\) is the applied density of force.

This could be added to the model with GWFL:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}initialized\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{F}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{n}{applied\PYGZus{}force}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}linear\PYGZus{}term}\PYG{p}{(}\PYG{n}{mim1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}lambda\PYGZus{}D.Test\PYGZus{}u1 + (alpha\PYGZus{}D*[0;1]\PYGZhy{}u1).Test\PYGZus{}lambda\PYGZus{}D}\PYG{l+s+s1}{\PYGZsq{}}
      \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ + (lambda\PYGZus{}D.[0;1]+F)*Test\PYGZus{}alpha\PYGZus{}D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{HOLE\PYGZus{}BOUND}\PYG{p}{)}
\end{sphinxVerbatim}

For more robustness, a small penalization on \(alpha_D\) can be added

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{add\PYGZus{}linear\PYGZus{}term}\PYG{p}{(}\PYG{n}{mim1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1E\PYGZhy{}6*alpha\PYGZus{}D*Test\PYGZus{}alpha\PYGZus{}D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

Note that the fixed size variable \sphinxtitleref{alpha\_D} is linked to each points of the rim boundary. This means that the line of the tangent matrix corresponding to \sphinxtitleref{alpha\_D} may have a lot of nonzero components. This is why such a use of fixed size variable have to be done with care.


\subsection{Model solve}
\label{\detokenize{tutorial/wheel:model-solve}}
We can now solve our problem with:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{solve}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}res}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{noisy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

Note that in some configuration, it is preferable to use a more basic line search than the default one:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{md}\PYG{o}{.}\PYG{n}{solve}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}res}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{1E\PYGZhy{}9}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{noisy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lsearch}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{simplest}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}  \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{alpha min}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mf}{0.8}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Export the solution}
\label{\detokenize{tutorial/wheel:export-the-solution}}
Now the code to export the solution with the VonMises stress:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{U1} \PYG{o}{=} \PYG{n}{md}\PYG{o}{.}\PYG{n}{variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{U2} \PYG{o}{=} \PYG{n}{md}\PYG{o}{.}\PYG{n}{variable}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{VM1} \PYG{o}{=} \PYG{n}{md}\PYG{o}{.}\PYG{n}{compute\PYGZus{}isotropic\PYGZus{}linearized\PYGZus{}Von\PYGZus{}Mises\PYGZus{}or\PYGZus{}Tresca}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clambdastar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cmu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfvm1}\PYG{p}{)}
\PYG{n}{VM2} \PYG{o}{=} \PYG{n}{md}\PYG{o}{.}\PYG{n}{compute\PYGZus{}isotropic\PYGZus{}linearized\PYGZus{}Von\PYGZus{}Mises\PYGZus{}or\PYGZus{}Tresca}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clambdastar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cmu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfvm2}\PYG{p}{)}

\PYG{n}{mfvm1}\PYG{o}{.}\PYG{n}{export\PYGZus{}to\PYGZus{}vtk}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{displacement\PYGZus{}with\PYGZus{}von\PYGZus{}mises1.vtk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfvm1}\PYG{p}{,}  \PYG{n}{VM1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Von Mises Stresses}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                     \PYG{n}{mfu1}\PYG{p}{,} \PYG{n}{U1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Displacements}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{mfvm2}\PYG{o}{.}\PYG{n}{export\PYGZus{}to\PYGZus{}vtk}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{displacement\PYGZus{}with\PYGZus{}von\PYGZus{}mises2.vtk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mfvm2}\PYG{p}{,}  \PYG{n}{VM2}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Von Mises Stresses}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                    \PYG{n}{mfu2}\PYG{p}{,} \PYG{n}{U2}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Displacements}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} You can view solutions with for instance:}
\PYG{c+c1}{\PYGZsh{} mayavi2 \PYGZhy{}d displacement\PYGZus{}with\PYGZus{}von\PYGZus{}mises1.vtk \PYGZhy{}f WarpVector \PYGZhy{}m Surface \PYGZhy{}d displacement\PYGZus{}with\PYGZus{}von\PYGZus{}mises2.vtk \PYGZhy{}f WarpVector \PYGZhy{}m Surface}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[scale=1.0]{{wheel}.png}
\caption{Plot of the solution.}\label{\detokenize{tutorial/wheel:id1}}\label{\detokenize{tutorial/wheel:tut-fig-wheelsol}}\end{figure}



\renewcommand{\indexname}{Index}
\printindex
\end{document}